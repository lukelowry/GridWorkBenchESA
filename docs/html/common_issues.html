<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"><meta name="viewport" content="width=device-width, initial-scale=1" />

      <title>Common Issues</title>
    
          <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="_static/theme.css " type="text/css" />
      
      <!-- sphinx script_files -->
        <script src="_static/documentation_options.js?v=4720776d"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>

      
      <!-- bundled in js (rollup iife) -->
      <!-- <script src="_static/theme-vendors.js"></script> -->
      <script src="_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="genindex.html" />
  <link rel="search" title="Search" href="search.html" />
  <link rel="prev" title="Examples" href="snippets.html" /> 
  </head>

  <body>
    <div id="app">
    <div class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="index.html" class="home-link">
    
      <img class="logo" src="_static/esa_logo.webp" alt="logo"/>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">



  
    <div class="nav-item">
      <a href="https://github.com/mzy2240/ESA"
        class="nav-link external">
          Github <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://pypi.org/project/esa/"
        class="nav-link external">
          PyPI <outboundlink></outboundlink>
      </a>
    </div>
  

    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            



  
    <div class="nav-item">
      <a href="https://github.com/mzy2240/ESA"
        class="nav-link external">
          Github <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://pypi.org/project/esa/"
        class="nav-link external">
          PyPI <outboundlink></outboundlink>
      </a>
    </div>
  

            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="index.html#easy-simauto-esa-documentation">Contents:</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 ">
            
              <a href="welcome.html" class="reference internal ">Introduction</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="installation.html" class="reference internal ">Installation</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="quick_start.html" class="reference internal ">Quick Start</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="overview.html" class="reference internal ">Overview</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="esa.html" class="reference internal ">API Documentation</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="snippets.html" class="reference internal ">Examples</a>
            

            
          </li>

        
          <li class="toctree-l1 current">
            
              <a href="#" class="reference internal current">Common Issues</a>
            

            
              <ul>
                
                  <li class="toctree-l2"><a href="#installation-virtual-environment-issues" class="reference internal">Installation/Virtual Environment Issues</a></li>
                
                  <li class="toctree-l2"><a href="#errors-issues-initializing-a-saw-instance" class="reference internal">Errors/Issues Initializing a SAW Instance</a></li>
                
              </ul>
            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
    
    <li>Common Issues</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="snippets.html"
       title="previous chapter">← Examples</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main" v-pre>
            
  <section id="common-issues">
<h1>Common Issues<a class="headerlink" href="#common-issues" title="Link to this heading">¶</a></h1>
<p>This section will describes some (maybe) common issues and their
solutions. If you encounter and solve an issue, please file a <a class="reference external" href="https://github.com/mzy2240/ESA/issues">GitHub
issue</a> so that we can add your
problem and solution to this section.</p>
<p>Before diving too deeply into the issues listed here, first ensure that
you have all the prerequisite software installed (including PowerWorld
Simulator and the SimAuto add-on) and are using a supported version of
Python (&gt;= 3.5).</p>
<section id="installation-virtual-environment-issues">
<span id="venv-issues"></span><h2>Installation/Virtual Environment Issues<a class="headerlink" href="#installation-virtual-environment-issues" title="Link to this heading">¶</a></h2>
<p>If you have issues installing ESA and/or its dependencies, you may need
to do some manual work installing prerequisites in your virtual
environment. Hopefully following these simple directions will help fix
most issues.</p>
<ol class="arabic simple">
<li><p>Start fresh! Completely remove your virtual environment and recreate
it. <a class="reference external" href="https://www.jetbrains.com/help/pycharm/creating-virtual-environment.html">PyCharm makes this pretty
easy</a>,
or you can do so manually using <a class="reference external" href="https://docs.python.org/3/tutorial/venv.html">Python’s
guide</a>. The
remaining directions will assume you’re typing commands into your
<strong>activated</strong> virtual envrionment.</p></li>
<li><p>Reinstall pip and setuptools:
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">--force-reinstall</span> <span class="pre">pip</span> <span class="pre">setuptools</span></code>.
We’re intentionally using <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span></code> instead of just <code class="docutils literal notranslate"><span class="pre">pip</span></code>
to avoid possible path issues. Note that you might need to run this
command twice (the first may fail for some unknown reason).</p></li>
<li><p>Check out ESA’s
<a class="reference external" href="https://github.com/mzy2240/ESA/blob/master/setup.py">setup.py</a>
file and look for <code class="docutils literal notranslate"><span class="pre">install_requires</span></code>. It’ll look something like
<code class="docutils literal notranslate"><span class="pre">['pandas',</span> <span class="pre">'numpy',</span> <span class="pre">'pywin32',</span> <span class="pre">'pypiwin32']</span></code>.</p></li>
<li><p>Using what we found under <code class="docutils literal notranslate"><span class="pre">install_requires</span></code>, install ESA’s
dependencies manually. To avoid compiler dependencies, we’ll get
binary distributions only:
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">--only-binary</span> <span class="pre">:all:</span> <span class="pre">pandas</span> <span class="pre">numpy</span> <span class="pre">pywin32</span> <span class="pre">pypiwin32</span></code></p>
<ul class="simple">
<li><p>If this command fails, you may need to pick and choose which
dependencies you grab binary distributions for, and which you get
other types of distributions for. Here’s the <a class="reference external" href="https://pip.pypa.io/en/stable/reference/pip_install/">Python
documentation</a>.
As a strictly illustrative example, if we only want to get binary
distributions for <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, we’d modify the
previous command to instead read like so:
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">--only-binary</span> <span class="pre">pandas,numpy</span> <span class="pre">pandas</span> <span class="pre">numpy</span> <span class="pre">pywin32</span> <span class="pre">pypiwin32</span></code></p></li>
<li><p>The authors of ESA have at times had issues installing pywin32 and
pypiwin32 when <em>not</em> using the <code class="docutils literal notranslate"><span class="pre">--only-binary</span></code> option. So, if
you’re encountering errors you suspect are related to pywin32,
try to uninstall and reinstall pywin32 and pypiwin32 with the
<code class="docutils literal notranslate"><span class="pre">--only-binary</span></code> option.</p></li>
</ul>
</li>
<li><p>After you’ve installed ESA’s dependencies, it’s time to install ESA:
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">esa</span></code></p></li>
</ol>
<section id="pycharm-virtual-environments">
<h3>PyCharm Virtual Environments<a class="headerlink" href="#pycharm-virtual-environments" title="Link to this heading">¶</a></h3>
<p>If you use PyCharm to automatically create virtual environments for you,
there’s a little extra work to do to get everything working for Python
3.8 (and possibly for other Python versions as well). Start up a
terminal <em>inside</em> PyCharm (click on the <code class="docutils literal notranslate"><span class="pre">Terminal</span></code> button which
defaults to the lower left area). In the terminal, run:
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-U</span> <span class="pre">--force-reinstall</span> <span class="pre">pip</span></code>. Note you may need to
run this command twice - mine failed the first time. The same may be
required for <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> and/or <code class="docutils literal notranslate"><span class="pre">distutils</span></code>.</p>
</section>
</section>
<section id="errors-issues-initializing-a-saw-instance">
<h2>Errors/Issues Initializing a SAW Instance<a class="headerlink" href="#errors-issues-initializing-a-saw-instance" title="Link to this heading">¶</a></h2>
<p>This section will cover some common issues when attempting to initialize
a SAW instance. The first thing to check is that your arguments are
correct - check the API documentation first.</p>
<section id="esa-saw-powerworlderror-opencase-errors-have-occurred">
<h3>esa.saw.PowerWorldError: OpenCase: Errors have occurred<a class="headerlink" href="#esa-saw-powerworlderror-opencase-errors-have-occurred" title="Link to this heading">¶</a></h3>
<p>You may see an error stack trace that looks something like the
following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;input&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
  <span class="n">File</span> <span class="s2">&quot;C:\Users\myuser\git\ESA\esa\saw.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">111</span><span class="p">,</span> <span class="ow">in</span> <span class="fm">__init__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">OpenCase</span><span class="p">(</span><span class="n">FileName</span><span class="o">=</span><span class="n">FileName</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;C:\Users\myuser\git\ESA\esa\saw.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">680</span><span class="p">,</span> <span class="ow">in</span> <span class="n">OpenCase</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_simauto</span><span class="p">(</span><span class="s1">&#39;OpenCase&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwb_file_path</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;C:\Users\myuser\git\ESA\esa\saw.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1101</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_call_simauto</span>
    <span class="k">raise</span> <span class="n">PowerWorldError</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">esa</span><span class="o">.</span><span class="n">saw</span><span class="o">.</span><span class="n">PowerWorldError</span><span class="p">:</span> <span class="n">OpenCase</span><span class="p">:</span> <span class="n">Errors</span> <span class="n">have</span> <span class="n">occurred</span>
</pre></div>
</div>
<p>Often, this is due to a bad path specification. Ensure you’re providing
a <strong>full</strong> file path, including the file extension (.pwb), and that the
file exists at the exact path you specified.</p>
<p>Also, make sure that the
file is <strong>actually</strong> a PowerWorld binary file. If you open the file with
a text editor and see a bunch of weird symbols that are unintelligible
to a mere mortal, it’s likely a PowerWorld binary file. If, upon opening
the file you see something like:</p>
<blockquote>
<div><div class="line-block">
<div class="line">version <a class="reference external" href="https://git-lfs.github.com/spec/v1">https://git-lfs.github.com/spec/v1</a></div>
<div class="line">oid sha256:f05131d24da96daa6a6712c5b9d368c81eeaea5dc7d0b6c7bec7d03ccf021b4a</div>
<div class="line">size 34</div>
</div>
</div></blockquote>
<p>Then you’re looking at a Git LFS pointer file, and likely need to
install <a class="reference external" href="https://git-lfs.github.com/">Git LFS</a> and perform a
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">lfs</span> <span class="pre">pull</span></code>.</p>
</section>
<section id="typeerror-this-com-object-can-not-automate-the-makepy-process-please-run-makepy-manually-for-this-object">
<h3>TypeError: This COM object can not automate the makepy process - please run makepy manually for this object<a class="headerlink" href="#typeerror-this-com-object-can-not-automate-the-makepy-process-please-run-makepy-manually-for-this-object" title="Link to this heading">¶</a></h3>
<p>If you see an error like the above, try initializing your SAW object
again but set <code class="docutils literal notranslate"><span class="pre">early_bind=False</span></code>. While we’re unsure of the root cause
of this issue, it seems to be related to the fact that
<code class="docutils literal notranslate"><span class="pre">early_bind=True</span></code> preemptively creates some Python files related to
the SimAuto COM API, and file permission issues can crop up.</p>
</section>
<section id="attributeerror-module-win32com-gen-py-c99f1760-277e-11d5-a106-00c04f469176x0x20x0-has-no-attribute-clsidtoclassmap">
<h3>AttributeError: module ‘win32com.gen_py.C99F1760-277E-11D5-A106-00C04F469176x0x20x0’ has no attribute ‘CLSIDToClassMap’<a class="headerlink" href="#attributeerror-module-win32com-gen-py-c99f1760-277e-11d5-a106-00c04f469176x0x20x0-has-no-attribute-clsidtoclassmap" title="Link to this heading">¶</a></h3>
<p>If you see an error like that listed above, it’s possible the pywin32
cache has been somehow corrupted (perhaps your computer crashed while
a script which uses ESA was running). Simply delete the following
directory (the default, you may have to adapt for your system):</p>
<p><code class="docutils literal notranslate"><span class="pre">C:\Users\&lt;your</span> <span class="pre">user</span> <span class="pre">directory&gt;\AppData\Local\Temp\gen_py</span></code></p>
<p>The key part here is <code class="docutils literal notranslate"><span class="pre">gen_py</span></code>. If the above path isn’t right for you,
use Windows to search for <code class="docutils literal notranslate"><span class="pre">gen_py</span></code>.</p>
</section>
<section id="modulenotfounderror-no-module-pywintypes">
<h3>ModuleNotFoundError: no module pywintypes<a class="headerlink" href="#modulenotfounderror-no-module-pywintypes" title="Link to this heading">¶</a></h3>
<p>If you see an error like that listed above, try reinstalling pywin32
and pypiwin32 with the <code class="docutils literal notranslate"><span class="pre">--only-binary</span></code> option, as described in the
<a class="reference internal" href="#venv-issues"><span class="std std-ref">Installation/Virtual Environment Issues</span></a> section.</p>
</section>
<section id="esa-saw-powerworlderror-access-violation">
<h3>esa.saw.PowerWorldError: Access Violation<a class="headerlink" href="#esa-saw-powerworlderror-access-violation" title="Link to this heading">¶</a></h3>
<p>If you see an error like that listed above, you probably could observe
the same errors using script functionality in the PowerWorld Simulator
interface. When you start the simulator (either the GUI or ESA) in a
remote desktop environment, due to security reasons the system may block
the simulator to save or create any files. As a result, any functions
that require the simulator to generate files will fail with such errors.
There are not much things we could do from our side, but one possible
hack is to login locally and use the simulator first, then use the
remote desktop to continue your work.</p>
</section>
</section>
</section>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="snippets.html"
       title="previous chapter">← Examples</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2024, Luke Lowery.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.4.7 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a> 0.9.1.
</div>
            </div>
          </div>
      </page>
    </div></div>
    
    
  </body>
</html>